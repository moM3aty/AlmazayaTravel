@{
    ViewData["Title"] = "Admin Login";
    Layout = null;
    var returnUrl = ViewData["ReturnUrl"] as string;
    var currentLang = System.Globalization.CultureInfo.CurrentUICulture.Name.StartsWith("ar") ? "ar" : "en";
}

<!DOCTYPE html>
<html lang="@currentLang">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title data-key="LoginTitle" data-en="Admin Login" data-ar="تسجيل دخول المسؤول">Admin Login - AlmazayaTravel</title>
    <link rel="icon" href="~/images/logo.png" type="image/png">
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/lib/fontawesome-free/css/all.min.css" />
    <link rel="stylesheet" href="~/css/admin-dashboard.css" asp-append-version="true" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Inter', sans-serif;
        }

        .login-card {
            max-width: 450px;
            width: 100%;
            padding: 2.5rem;
            border: none;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            background-color: #fff;
        }

        .login-logo {
            max-height: 70px;
            margin-bottom: 1.5rem;
        }

        .form-floating label {
            font-family: 'Inter', sans-serif;
        }

        body.rtl .form-floating label {
            font-family: 'Cairo', sans-serif;
            right: 0;
            left: auto;
            transform-origin: top right;
        }

        body.rtl {
            font-family: 'Cairo', sans-serif;
        }

        html[dir="rtl"] .ms-2 {
            margin-right: 0.5rem !important;
            margin-left: 0 !important;
        }

        html[dir="rtl"] .me-2 {
            margin-left: 0.5rem !important;
            margin-right: 0 !important;
        }

        .alert-sm {
            font-size: 0.85rem;
            padding: 0.5rem 0.8rem;
        }

    </style>
</head>
<body class="@(currentLang == "ar" ? "rtl" : "")">

    <div class="login-card">
        <div class="text-center">
            <img src="~/images/logo.png" alt="Almazaya Travel Logo" class="login-logo" />
            <h2 class="mb-4" data-key="LoginHeading" data-en="Admin Portal Login" data-ar="تسجيل دخول بوابة المسؤول">Admin Portal Login</h2>
        </div>

        <form asp-action="Login" method="post">
            @Html.AntiForgeryToken()
            <div asp-validation-summary="ModelOnly" class="alert alert-danger alert-sm p-2 text-center" role="alert"></div>

            <input type="hidden" name="returnUrl" value="@returnUrl" />

            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="username" name="username" placeholder="Username" required autofocus>
                <label for="username" data-key="UsernameLabel" data-en="Username" data-ar="اسم المستخدم">Username</label>
            </div>
            <div class="form-floating mb-4">
                <input type="password" class="form-control" id="password" name="password" placeholder="Password" required>
                <label for="password" data-key="PasswordLabel" data-en="Password" data-ar="كلمة المرور">Password</label>
            </div>

            <button class="btn btn-primary w-100 btn-lg rounded-pill" type="submit">
                <i class="fas fa-sign-in-alt me-2"></i> <span data-key="LoginBtnForm" data-en="Login" data-ar="تسجيل الدخول">Login</span>
            </button>
        </form>

        <div class="text-center mt-4">
            <a asp-controller="Home" asp-action="Index" class="text-decoration-none text-muted small" data-key="BackLink" data-en="&larr; Back to Main Site" data-ar="العودة للموقع الرئيسي &rarr;">&larr; Back to Main Site</a>
        </div>
    </div>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function applyLoginTranslation(lang) {
            console.log(`Applying login translation for: ${lang}`);
            document.documentElement.lang = lang;
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
            document.body.classList.toggle('rtl', lang === 'ar');

            document.querySelectorAll('[data-key]').forEach(el => {
                const text = el.getAttribute(`data-${lang}`) || el.getAttribute('data-en');
                if (text) {
                    if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                         if(el.placeholder !== undefined) el.placeholder = text;
                    } else if (el.tagName === 'LABEL' && el.parentElement?.classList.contains('form-floating')) {
                         el.textContent = text;
                    } else if (el.tagName === 'SPAN' && el.closest('button')) {
                         el.textContent = text;
                    }
                      else if (el.tagName === 'TITLE') {
                           document.title = text + " - AlmazayaTravel";
                      }
                      else {
                         el.textContent = text;
                    }
                }
            });
            console.log("Login translation applied.");
        }
        document.addEventListener('DOMContentLoaded', function () {
           const preferredLang = localStorage.getItem('adminLang') || 'en';
           applyLoginTranslation(preferredLang);
        });
    </script>
</body>
</html>
